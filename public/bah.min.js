function createDeck(a){var b=new Array;switch(a){case"white":for(i=0;i<MAX_WHITE_CARDS;i++)i<10?b[i]="white00"+i:i<100?b[i]="white0"+i:b[i]="white"+i;break;case"black":for(i=0;i<MAX_BLACK_CARDS;i++)i<10?b[i]="black00"+i:i<100?b[i]="black0"+i:b[i]="black"+i}return b=shuffleDeck(b)}function shuffleDeck(a){for(var b,c,d=a.length;d;)c=Math.floor(Math.random()*d--),b=a[d],a[d]=a[c],a[c]=b;return a}function dealWhite(a){for(var b=new Array,c=0;10>c;)b.push(a.shift()),c++;return b}function dealBlack(a){return a.shift()}function dealOneWhite(a){return a.shift()}function blankHand(){for($("#whitecards").empty(),i=0;i<10;i++)$("#whitecards").append('<img class="front whitecard" src="img/burn-back-white.png" width="150" />')}function nextRoundTimer(){var a=14,b=setInterval(function(){$("#timer").text("Next round in "+a+"..."),a--},1e3);setTimeout(function(){clearInterval(b),$("#timer").remove()},15e3)}function notifyTimer(){setTimeout(function(){$("#notify").remove()},5e3)}function cleanUp(){playing=!1,cardCzar=!1,score=0,$("#activeHand").empty(),$("#cardCzarName").text("No one!"),$("#score").text(score),$("#blackcard").flip(!1),$("#blackcard .back").empty(),blankHand(),boardHand=[],hasPlayed=!1}function newRound(){$("#activeHand").empty(),$("#titleBar").text("Burn Against Humanity - Play a card!"),$("#whitecards").children().each(function(){$(this).addClass("selectable")}),boardHand=[],hasPlayed=!1}var MAX_WHITE_CARDS=245,MAX_BLACK_CARDS=72,hand,boardHand=[],black,lastQuestion,lastAnswer,hasPlayed=!1,playing=!1,cardCzar=!1,pickWinner=!1,score=0;$(function(a){for(a("#blackcard").flip({trigger:"manual"}),null==lastQuestion&&a("#lastQuestion").append('<img class="blackcard" src="img/burn-back-black.png" width="130" />'),null==lastAnswer&&a("#lastAnswer").append('<img class="whitecard" src="img/burn-back-white.png" width="130" />'),i=0;i<10;i++)a("#whitecards").append('<img class="front whitecard" src="img/burn-back-white.png" width="150" />')});var socket=io();socket.on("connect",function(){socket.emit("adduser",prompt("What's your name?")),socket.on("endGame",function(){alert("Game over!\nYou scored: "+score),cleanUp()}),socket.on("newRound",function(a){newRound(),$("#blackcard .back").empty(),$("#blackcard .back").append('<img class="blackcard" src="img/smallblack/'+a.black+'.png" width="150" />'),$("#blackcard").flip(!0)}),socket.on("winner",function(a){$("#titleBar").text("Burn Against Humanity - Congratulations "+a.winName+"!"),$("#titleBar").append('<br><span id="timer">Next round in 15...</span>'),nextRoundTimer(),$("#blackcard").flip(!1),$("#winnerName").text(a.winName),$("#lastQuestion").empty(),$("#lastQuestion").append('<img class="blackcard" src="img/smallblack/'+black+'.png" width="130" />'),cardCzar=!1,$("#lastAnswer").empty(),$("#lastAnswer").append('<img id="'+a.answer+'" class="back whitecard" src="img/smallwhite/'+a.answer+'.png" width="130" />')}),socket.on("scored",function(){score++,$("#score").text(score)}),socket.on("areCzar",function(){cardCzar=!0,$("#titleBar").text("Burn Against Humanity - You are the card czar!")}),socket.on("updateCzar",function(a){$("#cardCzarName").text(a)}),socket.on("addCard",function(a){$("#whitecards").append('<img id="'+a.card+'" class="back selectable whitecard" src="img/smallwhite/'+a.card+'.png" width="150" />')}),socket.on("playerAdded",function(a){$("#titleBar").append('<br><span id="notify">Player '+a+" joined!</span>"),notifyTimer()}),socket.on("join",function(a){console.log(a),playing=!0,$("#titleBar").text("Burn Against Humanity - Play a card!"),$("#whitecards").empty(),console.log("test"),hand=a.whitecards,black=a.blackcard,$("#blackcard .back").html('<img class="blackcard" src="img/smallblack/'+black+'.png" width="150" />'),$.each(hand,function(a,b){$("#whitecards").append('<img id="'+b+'" class="back selectable whitecard" src="img/smallwhite/'+b+'.png" width="150" />')}),$("#blackcard").flip(!0)}),socket.on("cardPlayed",function(a){console.log("card received"),boardHand.push(a.card),$("#activeHand").append('<img class="front whitecard" src="img/burn-back-white.png" width="150" />')}),socket.on("waiting",function(a){$("#titleBar").text("Burn Against Humanity - Waiting for "+a.number+" more player(s).")}),socket.on("revealCards",function(){$("#activeHand").empty(),cardCzar?($("#titleBar").text("Burn Against Humanity - Pick your winning card!"),pickWinner=!0):$("#titleBar").text("Burn Against Humanity - Card Czar is picking a winner..."),$.each(boardHand,function(a,b){cardCzar?$("#activeHand").append('<img id="'+b+'" class="whitecard selectable" src="img/smallwhite/'+b+'.png" width="150" />'):$("#activeHand").append('<img id="'+b+'" class="back whitecard" src="img/smallwhite/'+b+'.png" width="150" />')}),$("#whitecards").children().each(function(){$(this).removeClass("selectable")}),boardHand=[]})}),$(document).on("click","#whitecards .whitecard",function(){hasPlayed||!playing||cardCzar?cardCzar?alert("You're the card czar!"):playing?alert("You've already played a card this round!"):alert("You're not in a game!"):(console.log("clicked on: "+$(this).attr("id")),socket.emit("addCard",{card:$(this).attr("id")}),hasPlayed=!0,$("#titleBar").text("Burn Against Humanity - Waiting for others..."),$(this).remove())}),$(document).on("click","#activeHand .whitecard",function(){cardCzar&&pickWinner?(console.log("clicked on: "+$(this).attr("id")),socket.emit("pickedWinner",{card:$(this).attr("id")}),pickWinner=!1):cardCzar?pickWinner?alert("You can't select this card!"):alert("Wait for the round to finish!"):alert("You're not the card czar!")});